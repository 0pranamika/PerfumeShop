<!DOCTYPE html>
<html lang="en">


<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>PERFUME SHOP</title>
    <meta name="keywords" content="HTML5 Template">
    <meta name="description" content="Perfume Shop">
    <meta name="author" content="p-themes">
    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="/static/user-assets/images/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/static/user-assets/images/logo2.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/static/user-assets/images/logo2.png">
    <link rel="manifest" href="/static/user-assets/images/icons/site.html">
    <link rel="mask-icon" href="/static/user-assets/images/icons/safari-pinned-tab.svg" color="#666666">
    <link rel="shortcut icon" href="/static/user-assets/images/logo2.png">
    <meta name="apple-mobile-web-app-title" content="Molla">
    <meta name="application-name" content="Molla">
    <meta name="msapplication-TileColor" content="#cc9966">
    <meta name="msapplication-config" content="/static/user-assets/images/icons/browserconfig.xml">
    <meta name="theme-color" content="#ffffff">
    <link rel="stylesheet" href="/static/user-assets/vendor/line-awesome/line-awesome/line-awesome/css/line-awesome.min.css">
    <!-- Plugins CSS File -->
    <link rel="stylesheet" href="/static/user-assets/css/bootstrap.min.css">
    <link rel="stylesheet" href="/static/user-assets/css/plugins/owl-carousel/owl.carousel.css">
    <link rel="stylesheet" href="/static/user-assets/css/plugins/magnific-popup/magnific-popup.css">
    <!-- Main CSS File -->
    <link rel="stylesheet" href="/static/user-assets/css/style.css">
    <link rel="stylesheet" href="/static/user-assets/css/plugins/nouislider/nouislider.css">
    <link rel="stylesheet" href="/static/user-assets/css/demos/demo-11.css">
</head>

<body>

        <!-- <main class="main"> -->
            <div class="login-page bg-image pt-8 pb-8 pt-md-12 pb-md-12 pt-lg-17 pb-lg-17" style="background-image: url('/static/user-assets/images/backgrounds/susan.jpg')">
            	<div class="container">
            		<div class="form-box">
            			<div class="form-tab">
							<div class="tab-content">
							    <!-- <div class="tab-pane fade show active" id="register-2" role="tabpanel" aria-labelledby="register-tab-2"> -->
									<form id="myForm" action="/register" method="post" enctype="multipart/form-data" onsubmit="return validation()">
                                        <%
                                            if(typeof message !=='undefined'){
                                            %>
                                            <h5> <%= message %> </h5>
                                            <%
                                        }
                                        %>
										<div style="position: relative; width: 100%;" class="justify-content-center text-center">
											<% 
											if (typeof errorMessage !== 'undefined') {
											%>
											<p style="position: absolute; transform: translate(-50%, -50%); left: 50%; color: rgb(251, 26, 1); white-space: nowrap;"><%= errorMessage %></p>
											<%
											}
											%>
										</div>
                                        <div class="form-group">
							    			<label for="Username">Name *</label>
							    			<input type="text" class="form-control" id="name" name="name" required  >
											<div id="errorName" class="mt-0 ms-2 position-right custom-text text-danger">
											</div>
							    		</div><!-- End .form-group -->

							    		<div class="form-group">
							    			<label for="Email address">Email address *</label>
							    			<input type="email" class="form-control" id="register-email-2" name="email" required>
											<div id="errorEmail" class="mt-0 ms-2 position-right custom-text text-danger">
											</div>
										</div><!-- End .form-group -->
                                        
                                        <div class="form-group">
							    			<label for="Phone number">Phone number *</label>
							    			<input type="text" class="form-control" id="mno" name="mno" required>
											<div id="errorNumber" class="mt-0 ms-2 position-right custom-text text-danger">
											</div>
										</div><!-- End .form-group -->

                                        <div class="form-group">
							    			<!-- <label for="image"></label> -->
							    			<input type="file"  name="image" required>
											<div id="errorFile" class="mt-0 ms-2 position-right custom-text text-danger">
										</div><!-- End .form-group-->

							    		<div class="form-group">
							    			<label for="Password">Password *</label>
							    			<input type="password" class="form-control" id="password" name="password" required>
											<div id="errorPassword" class="mt-0 ms-2 position-right custom-text text-danger">
											</div>
										</div><!-- End .form-group -->

							    		<div class="form-footer">
							    			<button type="submit" class="btn btn-outline-primary-2">
			                					<span>REGISTER</span>
			            						<i class="icon-long-arrow-right"></i>
                                            </button>
							    		</div><!-- End .form-footer -->
							    	</form>
							    	<div class="form-choice">
								    	<p class="text-center">or sign in with</p>
								    	<div class="row" style="margin-bottom: -52px;">
								    		<div class="col-sm-12">
								    			<a href="https://accounts.google.com/o/oauth2/v2/auth/oauthchooseaccount?response_type=code&redirect_uri=https%3A%2F%2Fs.typingclub.com%2Fm%2Fauth_callback.html&client_id=1036962974046-hsai0fu9h3huagfkqmn61nfuqgr01mn3.apps.googleusercontent.com&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.profile%20https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo.email&service=lso&o2v=2&theme=glif&flowName=GeneralOAuthFlow" class="btn btn-login btn-g">
								    				<i class="icon-google"></i>
								    				Login With Google
								    			</a>
								    		</div><!-- End .col-6 -->
                                            <p style="color: black;" class="mt-3">Already have an account? <a class="text-decoration-none" href="/login">Login</a></p>
                                            
								    	</div><!-- End .row -->
							    	</div><!-- End .form-choice -->
							    </div><!-- .End .tab-pane -->
							</div><!-- End .tab-content -->
						</div><!-- End .form-tab -->
            		</div><!-- End .form-box -->
            	</div><!-- End .container -->
            </div><!-- End .login-page section-bg -->
        </main><!-- End .main -->

	<script>
		function nameChecking(){
		let name=document.getElementById("name").value;

		if (name === "") {
				document.getElementById("errorName").innerHTML = "Please enter your name";
				return false;
			} else if (/^[a-zA-Z ]+$/.test(name) == false) {
				document.getElementById("errorName").innerHTML = "Please enter alphabets only";
				return false;
			} else {
                document.getElementById("errorName").innerHTML = "";
				return true;
			}
		}
		async function emailChecking(){
		let emailid=document.getElementById("email").value;
		let errorEmail = document.getElementById("errorEmail");

			if(/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(emailid)==false){
				document.getElementById("errorEmail").innerHTML="please enter a valid email id";
				return false
			}else{
				try {
					const response = await fetch('/checkEmailAvailability', {
						method: 'POST',
						headers: {
							'Content-Type': 'application/json'
						},
						body: JSON.stringify({ email: emailid })
					});

					const data = await response.json();

					if (data.exists) {
						errorEmail.innerHTML = "This email is already associated with an account.";
						return false;
					} else {
						errorEmail.innerHTML = "";
						return true;
					}
				} catch (error) {
					console.error(error);
					errorEmail.innerHTML = "Error checking email availability.";
					return false;
				}
			}
		}

		function numberChecking(){
		let num=document.getElementById("number").value;
		document.getElementById("errorNumber");

			if(/^\d{10}$/.test(num)==false){
				document.getElementById("errorNumber").innerHTML="please enter a valid number";
				return false
			}else{
				document.getElementById("errorNumber").innerHTML="";
				return true
			}
		}
		
		function passwordChecking(){
			let password=document.getElementById("password").value;
			if(password==""){
				document.getElementById("errorPassword").innerHTML="create your password";
				return false
			}
			else if(password.length <8){
				document.getElementById("errorPassword").innerHTML="enter minimum of 8 digits";
				return false
			}
			else{
				document.getElementById("errorPassword").innerHTML = "";
				return true
			}
		}
		function fileInputValidation() {
			let fileInput = document.querySelector('input[type="file"]');
			let errorFile = document.getElementById("errorFile");

			if (fileInput.files.length === 0) {
				errorFile.innerHTML = "Please select a file";
				return false;
			}

			// Optionally, you can add additional criteria such as file type and size
			let allowedFileTypes = ["image/jpeg", "image/png", "image/gif"];
			let maxFileSizeInBytes = 5242880; // 5 MB

			let selectedFileType = fileInput.files[0].type;
			let selectedFileSize = fileInput.files[0].size;

			if (!allowedFileTypes.includes(selectedFileType)) {
				errorFile.innerHTML = "Invalid file type. Please select a valid image file.";
				return false;
			}

			if (selectedFileSize > maxFileSizeInBytes) {
				errorFile.innerHTML = "File size exceeds the allowed limit (5 MB).";
				return false;
			}

			errorFile.innerHTML = "";
			return true;
		}

		function validation(){
			if(nameChecking() && emailChecking() && numberChecking() && passwordChecking() && fileInputValidation()){
				// document.getElementById("myForm").submit();                
				return true
			}
			else{
				nameChecking();
				emailChecking();
				numberChecking();
				passwordChecking();
				fileInputValidation()
				return false;
			}
		}
	</script>
    <!-- Plugins JS File -->
    <script src="/static/user-assets/js/jquery.min.js"></script>
    <script src="/static/user-assets/js/bootstrap.bundle.min.js"></script>
    <script src="/static/user-assets/js/jquery.hoverIntent.min.js"></script>
    <script src="/static/user-assets/js/jquery.waypoints.min.js"></script>
    <script src="/static/user-assets/js/superfish.min.js"></script>
    <script src="/static/user-assets/js/owl.carousel.min.js"></script>
    <!-- Main JS File -->
    <script src="/static/user-assets/js/main.js"></script>

</body>
</html>
